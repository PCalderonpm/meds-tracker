<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mis Medicamentos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #e8f5e8, #f0f8ff);
            min-height: 100vh;
            font-size: 18px;
            line-height: 1.6;
        }

        .container {
            max-width: 100%;
            padding: 15px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .week-selector {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .week-selector label {
            display: block;
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .week-selector input {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            border: 2px solid #ddd;
            border-radius: 10px;
            background: #f9f9f9;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: #f8f9fa;
            border: none;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: #4a90e2;
            color: white;
        }

        .tab:hover {
            background: #357abd;
            color: white;
        }

        .content {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .hidden {
            display: none;
        }

        /* Formulario Agregar Medicamento */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            border: 2px solid #ddd;
            border-radius: 10px;
            background: #f9f9f9;
        }

        .days-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .day-checkbox {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #ddd;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .day-checkbox:hover {
            background: #e9ecef;
        }

        .day-checkbox.selected {
            background: #4a90e2;
            color: white;
            border-color: #357abd;
        }

        .day-checkbox input {
            width: auto;
            margin-right: 8px;
            transform: scale(1.2);
        }

        .btn {
            width: 100%;
            padding: 18px;
            font-size: 20px;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #218838, #1c9b82);
            transform: translateY(-2px);
        }

        /* Lista de Medicamentos */
        .med-list {
            display: grid;
            gap: 15px;
        }

        .med-item {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border-left: 6px solid #4a90e2;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .med-name {
            font-size: 22px;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .med-dose {
            font-size: 18px;
            color: #666;
            margin-bottom: 10px;
        }

        .med-schedule {
            font-size: 16px;
            color: #888;
            margin-bottom: 15px;
        }

        .med-actions {
            display: flex;
            gap: 10px;
        }

        .btn-sm {
            padding: 10px 15px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        /* Seguimiento Semanal */
        .weekly-tracker {
            overflow-x: auto;
        }

        .tracker-table {
            width: 100%;
            min-width: 600px;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .tracker-table th,
        .tracker-table td {
            padding: 12px;
            text-align: center;
            border: 2px solid #dee2e6;
        }

        .tracker-table th {
            background: #4a90e2;
            color: white;
            font-size: 16px;
            font-weight: bold;
        }

        .tracker-table td {
            background: white;
            font-size: 16px;
        }

        .med-name-cell {
            text-align: left;
            font-weight: bold;
            background: #f8f9fa !important;
            min-width: 150px;
        }

        .check-circle {
            width: 35px;
            height: 35px;
            border: 3px solid #28a745;
            border-radius: 50%;
            cursor: pointer;
            margin: 0 auto;
            transition: all 0.3s ease;
            position: relative;
        }

        .check-circle.checked {
            background: #28a745;
        }

        .check-circle.checked::after {
            content: '✓';
            color: white;
            font-size: 20px;
            font-weight: bold;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .empty-state h3 {
            font-size: 22px;
            margin-bottom: 10px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 24px;
            }
            
            .tab {
                font-size: 14px;
                padding: 12px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>💊 Mis Medicamentos</h1>
            <p>Seguimiento fácil y seguro</p>
        </div>

        <div class="week-selector">
            <label for="weekInput">Semana del:</label>
            <input type="date" id="weekInput" onchange="updateWeekHeader()">
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('add')">➕ Agregar</button>
            <button class="tab" onclick="showTab('list')">📋 Mis Medicamentos</button>
            <button class="tab" onclick="showTab('tracker')">📅 Seguimiento</button>
        </div>

        <!-- Agregar Medicamento -->
        <div id="add-content" class="content">
            <h2>Agregar Nuevo Medicamento</h2>
            <form onsubmit="addMedication(event)">
                <div class="form-group">
                    <label for="medName">Nombre del Medicamento:</label>
                    <input type="text" id="medName" required placeholder="Ej: Levotiroxina">
                </div>

                <div class="form-group">
                    <label for="medDose">Dosis:</label>
                    <input type="text" id="medDose" required placeholder="Ej: 75mg">
                </div>

                <div class="form-group">
                    <label for="medTimes">Horarios (separados por coma):</label>
                    <input type="text" id="medTimes" required placeholder="Ej: 08:00, 20:00">
                </div>

                <div class="form-group">
                    <label>Días de la semana:</label>
                    <div class="days-selector">
                        <div class="day-checkbox" onclick="toggleDay(this)">
                            <input type="checkbox" name="days" value="Lun">
                            <span>Lunes</span>
                        </div>
                        <div class="day-checkbox" onclick="toggleDay(this)">
                            <input type="checkbox" name="days" value="Mar">
                            <span>Martes</span>
                        </div>
                        <div class="day-checkbox" onclick="toggleDay(this)">
                            <input type="checkbox" name="days" value="Mié">
                            <span>Miércoles</span>
                        </div>
                        <div class="day-checkbox" onclick="toggleDay(this)">
                            <input type="checkbox" name="days" value="Jue">
                            <span>Jueves</span>
                        </div>
                        <div class="day-checkbox" onclick="toggleDay(this)">
                            <input type="checkbox" name="days" value="Vie">
                            <span>Viernes</span>
                        </div>
                        <div class="day-checkbox" onclick="toggleDay(this)">
                            <input type="checkbox" name="days" value="Sáb">
                            <span>Sábado</span>
                        </div>
                        <div class="day-checkbox" onclick="toggleDay(this)">
                            <input type="checkbox" name="days" value="Dom">
                            <span>Domingo</span>
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">Agregar Medicamento</button>
            </form>
        </div>

        <!-- Lista de Medicamentos -->
        <div id="list-content" class="content hidden">
            <h2>Mis Medicamentos</h2>
            <div id="med-list" class="med-list">
                <div class="empty-state">
                    <h3>No hay medicamentos agregados</h3>
                    <p>Usa la pestaña "Agregar" para añadir tu primer medicamento</p>
                </div>
            </div>
        </div>

        <!-- Seguimiento Semanal -->
        <div id="tracker-content" class="content hidden">
            <h2>Seguimiento Semanal</h2>
            <div id="week-display"></div>
            <div class="weekly-tracker">
                <table class="tracker-table" id="tracker-table">
                    <thead>
                        <tr>
                            <th>Medicamento</th>
                            <th>Lun</th>
                            <th>Mar</th>
                            <th>Mié</th>
                            <th>Jue</th>
                            <th>Vie</th>
                            <th>Sáb</th>
                            <th>Dom</th>
                        </tr>
                    </thead>
                    <tbody id="tracker-body">
                        <tr>
                            <td colspan="8" class="empty-state">
                                <h3>No hay medicamentos para mostrar</h3>
                                <p>Agrega medicamentos para ver el seguimiento semanal</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let medications = [];
        let currentWeek = '';

        // Inicializar la aplicación
        function init() {
            loadMedications();
            setCurrentWeek();
            updateWeekHeader();
            renderMedicationList();
            renderTracker();
        }

        // Cargar medicamentos del almacenamiento
        function loadMedications() {
            const stored = JSON.parse(localStorage.getItem('medications') || '[]');
            medications = stored;
        }

        // Guardar medicamentos
        function saveMedications() {
            localStorage.setItem('medications', JSON.stringify(medications));
        }

        // Establecer semana actual
        function setCurrentWeek() {
            const today = new Date();
            const monday = new Date(today);
            monday.setDate(today.getDate() - today.getDay() + 1);
            
            const year = monday.getFullYear();
            const month = String(monday.getMonth() + 1).padStart(2, '0');
            const day = String(monday.getDate()).padStart(2, '0');
            
            document.getElementById('weekInput').value = `${year}-${month}-${day}`;
            currentWeek = `${year}-${month}-${day}`;
        }

        // Actualizar encabezado de semana
        function updateWeekHeader() {
            const dateInput = document.getElementById('weekInput');
            currentWeek = dateInput.value;
            
            if (currentWeek) {
                const date = new Date(currentWeek);
                const options = { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                };
                const formattedDate = date.toLocaleDateString('es-ES', options);
                document.getElementById('week-display').innerHTML = 
                    `<h3>Semana del ${formattedDate}</h3>`;
            }
            
            renderTracker();
        }

        // Cambiar pestañas
        function showTab(tabName) {
            // Ocultar todos los contenidos
            document.querySelectorAll('.content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Remover clase active de todas las pestañas
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Mostrar contenido seleccionado
            document.getElementById(tabName + '-content').classList.remove('hidden');
            
            // Activar pestaña seleccionada
            event.target.classList.add('active');
        }

        // Toggle selección de días
        function toggleDay(element) {
            const checkbox = element.querySelector('input');
            checkbox.checked = !checkbox.checked;
            element.classList.toggle('selected', checkbox.checked);
        }

        // Agregar medicamento
        function addMedication(event) {
            event.preventDefault();
            
            const name = document.getElementById('medName').value;
            const dose = document.getElementById('medDose').value;
            const times = document.getElementById('medTimes').value.split(',').map(t => t.trim());
            
            const selectedDays = [];
            document.querySelectorAll('input[name="days"]:checked').forEach(input => {
                selectedDays.push(input.value);
            });
            
            if (selectedDays.length === 0) {
                alert('Por favor selecciona al menos un día de la semana');
                return;
            }
            
            const medication = {
                id: Date.now(),
                name: name,
                dose: dose,
                times: times,
                days: selectedDays,
                tracking: {}
            };
            
            medications.push(medication);
            saveMedications();
            
            // Limpiar formulario
            document.getElementById('medName').value = '';
            document.getElementById('medDose').value = '';
            document.getElementById('medTimes').value = '';
            document.querySelectorAll('input[name="days"]').forEach(input => {
                input.checked = false;
                input.parentElement.classList.remove('selected');
            });
            
            renderMedicationList();
            renderTracker();
            
            alert('Medicamento agregado exitosamente');
        }

        // Renderizar lista de medicamentos
        function renderMedicationList() {
            const listContainer = document.getElementById('med-list');
            
            if (medications.length === 0) {
                listContainer.innerHTML = `
                    <div class="empty-state">
                        <h3>No hay medicamentos agregados</h3>
                        <p>Usa la pestaña "Agregar" para añadir tu primer medicamento</p>
                    </div>
                `;
                return;
            }
            
            listContainer.innerHTML = medications.map(med => `
                <div class="med-item">
                    <div class="med-name">${med.name}</div>
                    <div class="med-dose">Dosis: ${med.dose}</div>
                    <div class="med-schedule">
                        Horarios: ${med.times.join(', ')}<br>
                        Días: ${med.days.join(', ')}
                    </div>
                    <div class="med-actions">
                        <button class="btn-sm btn-danger" onclick="deleteMedication(${med.id})">
                            🗑️ Eliminar
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Eliminar medicamento
        function deleteMedication(id) {
            if (confirm('¿Estás seguro de que quieres eliminar este medicamento?')) {
                medications = medications.filter(med => med.id !== id);
                saveMedications();
                renderMedicationList();
                renderTracker();
            }
        }

        // Renderizar seguimiento
        function renderTracker() {
            const tbody = document.getElementById('tracker-body');
            
            if (medications.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" class="empty-state">
                            <h3>No hay medicamentos para mostrar</h3>
                            <p>Agrega medicamentos para ver el seguimiento semanal</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const days = ['Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb', 'Dom'];
            
            tbody.innerHTML = medications.map(med => {
                return `
                    <tr>
                        <td class="med-name-cell">${med.name}<br><small>${med.dose}</small></td>
                        ${days.map(day => {
                            const isScheduled = med.days.includes(day);
                            const trackingKey = `${currentWeek}-${day}`;
                            const isTaken = med.tracking && med.tracking[trackingKey];
                            
                            if (!isScheduled) {
                                return '<td style="background: #f8f9fa;">-</td>';
                            }
                            
                            return `
                                <td>
                                    <div class="check-circle ${isTaken ? 'checked' : ''}" 
                                         onclick="toggleTracking(${med.id}, '${day}')">
                                    </div>
                                </td>
                            `;
                        }).join('')}
                    </tr>
                `;
            }).join('');
        }

        // Toggle seguimiento
        function toggleTracking(medId, day) {
            const medication = medications.find(med => med.id === medId);
            if (!medication) return;
            
            if (!medication.tracking) {
                medication.tracking = {};
            }
            
            const trackingKey = `${currentWeek}-${day}`;
            medication.tracking[trackingKey] = !medication.tracking[trackingKey];
            
            saveMedications();
            renderTracker();
        }

        // Inicializar cuando la página carga
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
